<html>
<head>
    <title>Agenda</title>
</head>
<body>
    <h1>Criar novo cliente</h1>
    <form th:action="@{/cliente/criar}" method="post" th:object="${criarClienteRequest}">
        <label for="nome">
            <span>Nome</span>
            <input id="nome" th:field="*{nome}" type="text" required>
        </label>
        <br><br>
        <label for="telefone">
            <span>Telefone</span>
            <input id="telefone" th:field="*{telefone}" type="tel" required>
        </label>
        <br><br>
        <div>
            <button type="button"><a href="/cliente">Cancelar</a></button>
            <button type="submit">Salvar</button>
        </div>
    </form>
    <div th:if="${erro}">
        <p th:text="${erro}"></p>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
          const telefoneInput = document.getElementById('telefone');
          telefoneInput.addEventListener('input', function (e) {
            let value = e.target.value.replace(/\D/g, ''); // remove tudo que não é número
            if (value.length > 11) value = value.slice(0, 11); // limita a 11 dígitos

            if (value.length > 6) {
              // Formata com DDD + 5 dígitos + hífen
              e.target.value = `(${value.slice(0,2)}) ${value.slice(2,7)}-${value.slice(7)}`;
            } else if (value.length > 2) {
              // Formata com DDD e parte inicial
              e.target.value = `(${value.slice(0,2)}) ${value.slice(2)}`;
            } else {
              // Apenas os números que o usuário digitou
              e.target.value = value;
            }
          });
        });
    </script>

</body>
</html>